"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[614],{614:(C,p,i)=>{i.r(p),i.d(p,{EditPageModule:()=>T});var h=i(6814),o=i(95),r=i(7852),c=i(7928),v=i(5861),u=i(4073),l=i(9493),Z=i(2283),b=i(6033),E=i(553),e=i(9468);function y(n,m){if(1&n&&e._UZ(0,"ion-img",21),2&n){const t=e.oxw();e.Q6J("src",null==t.documents||null==t.documents.imagem?null:t.documents.imagem.url)("alt","Foto do contato "+t.editForm.value.name)}}function F(n,m){if(1&n&&e._UZ(0,"ion-img",21),2&n){const t=e.oxw();e.Q6J("src",t.imagem.url)("alt","Foto alterada do contato "+t.editForm.value.name)}}const I=[{path:"",component:(()=>{class n{constructor(t,a,s,g,d,f){this.general=t,this.cepService=a,this.firestore=s,this.fb=g,this.storage=d,this.router=f,this.env=E.N,this.alertSend=!1,this.alertButtons=[{text:"Cancel",handler:()=>{this.alertSend=!1}},{text:"Confirm",handler:()=>{this.sendForm()}}],this.imagem={url:"",format:"",uploaded:!1},this.form={},this.sending=!1,this.docId="0",this.editForm=this.fb.group({name:["",[o.kI.minLength(3),o.kI.pattern("[^0-9]*"),o.kI.required]],email:["",[o.kI.minLength(5),o.kI.email,o.kI.required]],cep:["",[o.kI.minLength(8),o.kI.pattern("[0-9]*"),o.kI.required]],logradouro:["",[o.kI.minLength(3),o.kI.required]],local:["",[o.kI.minLength(3),o.kI.required]],bairro:["",[o.kI.minLength(3),o.kI.required]],subject:["",[o.kI.minLength(3),o.kI.required]],message:["",[o.kI.minLength(5),o.kI.required]]}),this.contactsCollection=(0,u.hJ)(this.firestore,"contacts")}getCep(){this.editForm.value.cep.length<8||this.editForm.value.cep.length>9||this.cepService.getCep(this.editForm.value.cep).subscribe(t=>{this.editForm.patchValue({logradouro:t.logradouro,local:t.localidade,bairro:t.bairro})})}ngOnInit(){var t=this;return(0,v.Z)(function*(){if(t.docId=void 0===history.state.index?"0":history.state.index,"0"!==t.docId){try{t.docSnap=yield(0,u.QT)((0,u.JU)(t.firestore,"contacts",t.docId)),t.documents=t.docSnap.data(),t.editForm.setValue({name:t.documents.form.name,email:t.documents.form.email,cep:t.documents.form.cep,logradouro:t.documents.form.logradouro,local:t.documents.form.local,bairro:t.documents.form.bairro,subject:t.documents.form.subject,message:t.documents.form.message})}catch(a){console.error("Error fetching document:",a)}void 0===t.documents&&location.reload()}else t.router.navigate(["/home"])})()}ngOnDestroy(){this.general.formValues(this.form,null),this.general.formValues(this.documents,null)}sendForm(){var t=this;return(0,v.Z)(function*(){if(t.imagem.uploaded&&!t.sending){t.sending=!0;try{var a=t.documents.imagem.name;if(t.imagem.uploaded){const s=(0,l.cF)(),g=(0,l.iH)(s,`${t.documents.imagem.name}.${t.documents.imagem.format}`);yield(0,l.oq)(g).catch(x=>{console.log("Error deleting image",x)}),a=t.general.getRandomChars(10);const d=(0,l.iH)(t.storage,`${a}.${t.imagem.format}`);yield(0,l.sf)(d,t.imagem.url.split(",")[1],"base64",{contentType:`image/${t.imagem.format}`});const f=yield(0,l.Jt)((0,l.iH)(d));t.documents.imagem.url=f,t.documents.imagem.format=t.imagem.format}yield(0,u.r7)((0,u.JU)(t.firestore,"contacts",t.docId),{form:{name:t.editForm.value.name,email:t.editForm.value.email,cep:t.editForm.value.cep,logradouro:t.editForm.value.logradouro,local:t.editForm.value.local,bairro:t.editForm.value.bairro,subject:t.editForm.value.subject,message:t.editForm.value.message},imagem:{url:t.imagem.url,format:t.imagem.format,name:a}})}catch(s){return console.error("Error sending form",s),void(t.sending=!1)}finally{t.general.formValues(t.form,null),t.general.formValues(t.documents,null),t.sending=!1,setTimeout(()=>{t.router.navigate(["/home"])},1e3)}}})()}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(b.m),e.Y36(Z.q),e.Y36(u.gg),e.Y36(o.qu),e.Y36(l.Ke),e.Y36(c.F0))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-edit"]],decls:45,vars:11,consts:[[3,"translucent"],["slot","start"],[1,"ion-text-center"],["name","pencil","size","large","slot","end",1,"ion-margin"],[1,"ion-padding"],[3,"formGroup"],["label","Nome:","type","text","name","name","label-placement","floating","fill","outline","placeholder","Seu nome completo","error-text","Nome inv\xe1lido!","formControlName","name",3,"autofocus"],["label","Email:","type","email","name","email","label-placement","floating","fill","outline","placeholder","Seu e-mail","error-text","E-mail inv\xe1lido!","formControlName","email"],["label","Cep:","type","text","name","cep","label-placement","floating","fill","outline","placeholder","Seu cep","error-text","Cep inv\xe1lido!","formControlName","cep",3,"keyup"],["label","Estado:","type","text","name","logradouro","label-placement","floating","fill","outline","placeholder","Seu estado","error-text","Estado inv\xe1lido!","formControlName","logradouro"],["label","Cidade:","type","text","name","local","label-placement","floating","fill","outline","placeholder","Sua cidade","error-text","Local inv\xe1lido!","formControlName","local"],["label","Bairro:","type","text","name","bairro","label-placement","floating","fill","outline","placeholder","Seu bairro","error-text","Bairro inv\xe1lido!","formControlName","bairro"],["label","Assunto:","type","text","name","subject","label-placement","floating","fill","outline","placeholder","Assunto do contato","error-text","Assunto inv\xe1lido!","formControlName","subject"],["label","Mensagem:","name","message","labelPlacement","floating","fill","outline","placeholder","Mensagem do contato","error-text","Mensagem inv\xe1lida!","formControlName","message",3,"autoGrow"],[3,"src","alt",4,"ngIf"],["expand","full",3,"click"],["name","pencil","slot","start"],["name","send","slot","start"],["header","Realmente deseja alterar os dados deste contato?",3,"buttons","isOpen"],["showBackdrop","false","message","Carregando...","spinner","circles",1,"custom-loading",3,"isOpen"],["target","_blank","title","copyright",3,"href"],[3,"src","alt"]],template:function(t,a){1&t&&(e.TgZ(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-buttons",1),e._UZ(3,"ion-menu-button"),e.qZA(),e.TgZ(4,"ion-title",2),e._uU(5,"Editar Contato"),e.qZA(),e._UZ(6,"ion-icon",3),e.qZA()(),e.TgZ(7,"ion-content",4)(8,"form",5)(9,"p"),e._uU(10,'Altere os dados dos campos e aperte "enviar para editar o contato".'),e.qZA(),e.TgZ(11,"p"),e._UZ(12,"ion-input",6),e.qZA(),e.TgZ(13,"p"),e._UZ(14,"ion-input",7),e.qZA(),e.TgZ(15,"p")(16,"ion-input",8),e.NdJ("keyup",function(){return a.getCep()}),e.qZA()(),e.TgZ(17,"p"),e._UZ(18,"ion-input",9),e.qZA(),e.TgZ(19,"p"),e._UZ(20,"ion-input",10),e.qZA(),e.TgZ(21,"p"),e._UZ(22,"ion-input",11),e.qZA(),e.TgZ(23,"p"),e._UZ(24,"ion-input",12),e.qZA(),e.TgZ(25,"p"),e._UZ(26,"ion-textarea",13),e.qZA(),e.TgZ(27,"ion-item"),e.YNc(28,y,1,2,"ion-img",14),e.YNc(29,F,1,2,"ion-img",14),e.qZA(),e.TgZ(30,"ion-item")(31,"ion-button",15),e.NdJ("click",function(){return a.general.getPhoto(a.imagem)}),e._UZ(32,"ion-icon",16),e._uU(33," Alterar Foto "),e.qZA()(),e.TgZ(34,"ion-item")(35,"ion-button",15),e.NdJ("click",function(){return a.alertSend=!0}),e._UZ(36,"ion-icon",17),e._uU(37," Enviar para Editar "),e.qZA()()(),e._UZ(38,"ion-alert",18)(39,"ion-loading",19),e.qZA(),e.TgZ(40,"ion-footer")(41,"ion-toolbar")(42,"ion-title",2)(43,"a",20),e._uU(44),e.qZA()()()()),2&t&&(e.Q6J("translucent",!0),e.xp6(8),e.Q6J("formGroup",a.editForm),e.xp6(4),e.Q6J("autofocus",!0),e.xp6(14),e.Q6J("autoGrow",!0),e.xp6(2),e.Q6J("ngIf",!a.imagem.uploaded),e.xp6(1),e.Q6J("ngIf",a.imagem.uploaded),e.xp6(9),e.Q6J("buttons",a.alertButtons)("isOpen",a.alertSend),e.xp6(1),e.Q6J("isOpen",a.sending),e.xp6(4),e.Q6J("href",a.env.authorUrl,e.LSH),e.xp6(1),e.hij("\xa9 2023 ",a.env.author,"."))},dependencies:[h.O5,r.Ge,r.YG,r.Sm,r.W2,r.fr,r.Gu,r.gu,r.Xz,r.pK,r.Ie,r.wh,r.fG,r.g2,r.wd,r.sr,r.j9,o._Y,o.JJ,o.JL,o.sg,o.u]}),n})()}];let A=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[c.Bz.forChild(I),c.Bz]}),n})(),T=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[h.ez,r.Pc,A,o.UX]}),n})()}}]);